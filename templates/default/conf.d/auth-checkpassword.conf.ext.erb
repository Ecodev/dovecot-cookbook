# Authentication for checkpassword users. Included from auth.conf.
#
# <doc/wiki/AuthDatabase.CheckPassword.txt>

<% if @auth['checkpassword'].kind_of?(Hash) and @auth['checkpassword'].length > 0 and
      @auth['checkpassword']['passdb'].kind_of?(Hash) -%>
<%=  Dovecot::Conf.authdb('passdb', @auth['checkpassword']['passdb']) %>
<% else -%>
passdb {
  driver = checkpassword
  args = /usr/bin/checkpassword
}
<% end -%>

<% if @auth['checkpassword'].kind_of?(Hash) and @auth['checkpassword'].length > 0 and
      @auth['checkpassword']['userdb'].kind_of?(Hash) -%>
<%=  Dovecot::Conf.authdb('userdb', @auth['checkpassword']['userdb']) %>
<% else -%>
# passdb lookup should return also userdb info
userdb {
  driver = prefetch
}
<% end -%>

# Standard checkpassword doesn't support direct userdb lookups.
# If you need checkpassword userdb, the checkpassword must support
# Dovecot-specific extensions.
#userdb {
#  driver = checkpassword
#  args = /usr/bin/checkpassword
#}
